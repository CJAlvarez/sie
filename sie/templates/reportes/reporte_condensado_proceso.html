{% extends "dashboard.html"%}

        {% block contenido %}
<h3>Reporte Condensado Proceso</h3>
<hr>





       <div class="col-xs-3 col-sm-3 col-md-3 col-lg-2 ">
             <div class="form-group">
      <h5><span class="label label-success">Filtros</span></h5>
              <select multiple class="form-control" id="sel1" name="filtro">
                  {% for MasterFiltroHQ in filtros %}
                <option value="{{MasterFiltroHQ.tabla}}{{MasterFiltroHQ.nombre}}" >{{MasterFiltroHQ.alias}}</option>
                  {% endfor %}

              </select>

            </div>


       </div>
       <div id="clear">

       <div class="col-xs-12 col-sm-4 col-md-4 col-lg-3 ">
              <h5><span class="label label-success">Opciones  </span></h5>

              <form  id="fomulario" action="/exportar/" method="post" role="form" enctype="multipart/form-data">


            <select name="zip" id="zip" class="form-control">
                <option value="0">-----Seleccione CECAPS--------</option>

                    {% for c in nombres %}
                 <option value="''{{c.username}}''">{{c.username}}</option>
                      {% endfor %}




            </select>

              <select  class="form-control" id="proceso" name="proceso">
                  {% for a in procesoeducativo %}
                <option value="''{{a.Nombre_Proceso}}''" >{{a.Nombre_Proceso}}</option>
                                      {% endfor %}

              </select>


               <select name="departamento" id="departamento" class="form-control">
                   <option value="0">-----Seleccione Departamento --------</option>

                    {% for d in departamentos %}
                 <option value="''{{d.dep_departamento}}''">{{d.dep_departamento}}</option>
                      {% endfor %}

               </select>

                <p>Date</p>
              <input type="date" name="date" id="datepicker" class="form-control" value="" required="required" title="">
 <p>Numeros</p>
              <input type="number" name="numero" id="numero" class="form-control" value="" min="{0"} max="100" step="" title="">


       </div>



      <div class="col-xs-12 col-sm-3 col-md-3 col-lg-2">
                      <h5><span class="label label-success">Operadores</span></h5>

           <div class="form-group">
              <label for="sel2">Selecciona Operador:</label>
              <select class="form-control" id="operador" name="operador">
                  <option value="">Seleccione Operador</option>
                <option value="=">Igual =</option>
                  <option value="<>">Distinto <></option>
                  <option value=">">Mayor que ></option>
                  <option value="<">Menor que<</option>
                  <option value=">=">Mayor o igual >=</option>
                  <option value="<=">Menor o igual <=</option>
                <option value="+">Suma +</option>
                <option value="BETWEEN">BETWEEN</option>

              </select>


            </div>
          <select class="form-control" id="andor" name="andor">
         <option value="">Seleccione Condicion</option>

                <option value="AND">AND</option>
                <option value="OR">OR</option>

              </select>



        <button id="limpiar" type="button" class="btn btn-danger btn-sm">Limpiar</button>
      </div>


</form>

<div class="col-xs-12 col-sm-12 col-md-12 col-lg-9 ">
<div class="col-xs-12 col-sm-12 col-md-12 col-lg-9 well">



<form  action="" method="post" id="formulario" role="form" enctype="multipart/form-data" >





    <table class="table table-bordered table-hover" id="tabla" >
        <thead>
            <tr>
               <tr>
            <th>Filtro</th>
            <th>Operador</th>
            <th>Valor</th>
            <th>Condicion</th>



        </thr>
            </tr>
        </thead>
        <tbody>
        <input type="button" class="btn btn-success" id="agregar" value="Agregar Filtro" />
                <button type="button"  id="del" class="btn btn-danger btn-sm">Eliminar Filtro</button>
                 <button type="button"  id="reset" class="btn btn-info btn-sm">Limpiar Filtros</button>


            <td id="sz"></td>
            <td id="oper"></td>
            <td id="pa"></td>
            <td id="co"></td>

        </tr>
        </tbody>
    </table>
<table class="table table-hover" id="eliminar">
    <thead>
        <tr>
            <th>Filtros Seleccionado</th>

        </tr>
    </thead>
    <tbody id='perron'>
        <tr class="fila-base">
            <td id="resultado"></td>
        </tr>
    </tbody>
</table>

 </form>

<div id='valores'></div>
</div>



  
</div>



<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="overflow-y: auto; height:autox; ">
  <style type="text/css" media="screen">
  .c{

    background-color:#6EE1DD;
  }
    .a{

    background-color:#D5E16E;
  }
    .b{

    background-color:#E1906E;
  }
    .d{

    background-color:#E16E6E;
  }
</style>


  <table class="table table-striped" id="customers">
    <thead>

<tr>
   

        <th colspan="4" class="c" rowspan="" headers="" scope=""><label>Asistencia a Módulo o Evento en Horas</label></th>  
       


</tr>
<tr>
 
        <th colspan="4"rowspan=""  class="b" headers="" scope=""><label>Evaluacion por modulo (%)</label></th>  

</tr>
      <tr>
        <th>CECAP</th>
        <th>Nombre Completo</th>
        <th>Identidad</th>
        <th>Sexo</th>
        <th>Edad Años</th>
        <th>Nivel Educativo</th>
        <th class="c"data-item="1">1</th>
        <th class="c"data-item="2">2</th>
        <th class="c"data-item="3">3</th>
        <th class="c"data-item="4">4</th>
        <th class="c"data-item="5">5</th>
        <th class="c"data-item="6">6</th>
        <th class="c"data-item="7">7</th>
        <th class="c" data-item="8">8</th>
        <th class="c" data-item="9">9</th>
        <th class="c" data-item="10">10</th>
        <th class="c" data-item="11">11</th>
        <th class="c" data-item="12">12</th>
        <th class="c" data-item="13">13</th>
        <th class="c" data-item="14">14</th>
        <th class="c" data-item="15">15</th>
        <th class="c" data-item="16">16</th>
        <th class="c" data-item="17">17</th>
        <th class="c" data-item="18">18</th>
        <th class="c" data-item="19">19</th>
        <th class="c" data-item="20">20</th>
        <th class="c" data-item="21">21</th>
        <th class="c" data-item="22">22</th>
        <th class="c" data-item="23">23</th>
        <th class="c" data-item="24">24</th>
        <th class="c" data-item="25">25</th>
        <th class="c" data-item="26">26</th>
        <th class="c" data-item="27">27</th>
        <th class="c" data-item="28">28</th>

        <th>Asistencia Total (Horas)</th>
        <th>Porcentaje de asistencia Horas</th>
        <th  class="b"data-item-w="1">1</th>
        <th  class="b"data-item-w="2">2</th>
        <th  class="b"data-item-w="3">3</th>
        <th  class="b"data-item-w="4">4</th>
        <th  class="b"data-item-w="5">5</th>
        <th  class="b"data-item-w="6">6</th>
        <th  class="b"data-item-w="7">7</th>
        <th  class="b"data-item-w="8">8</th>
        <th  class="b"data-item-w="9">9</th>
        <th  class="b"data-item-w="10">10</th>
        <th  class="b"data-item-w="11">11</th>
        <th  class="b"data-item-w="12">12</th>
        <th  class="b"data-item-w="13">13</th>
        <th  class="b"data-item-w="14">14</th>
        <th  class="b"data-item-w="15">15</th>
        <th  class="b"data-item-w="16">16</th>
        <th  class="b"data-item-w="17">17</th>
        <th  class="b"data-item-w="18">18</th>
        <th  class="b"data-item-w="19">19</th>
        <th  class="b"data-item-w="20">20</th>
        <th  class="b"data-item-w="21">21</th>
        <th  class="b"data-item-w="22">22</th>
        <th  class="b"data-item-w="23">23</th>
        <th  class="b"data-item-w="24">24</th>
        <th  class="b"data-item-w="25">25</th>
        <th  class="b"data-item-w="26">26</th>
        <th  class="b"data-item-w="27">27</th>
        <th class="b" data-item-w="28">28</th>

        <th>% Final</th>
        <th>Certificacion</th>
        <th>Deserto</th>
        <th>Causa Desercion</th>
      </tr>
    </thead>
    <tbody>
      {% for a in resultado %}
      <tr>
        <td>{{a.cecap}}</td>
        <td>{{a.nombre}}</td>
        <td>{{a.identidad}}</td>
        <td>{{a.sexo}}</td>
        <td>{{a.edad}}</td>
        <td>{{a.niveleducativo}}</td>
        <td class="c" data-item-e="1">{{a.modulo1}}</td>
        <td class="c" data-item-e="2">{{a.modulo2}}</td>
        <td class="c" data-item-e="3">{{a.modulo3}}</td>
        <td class="c" data-item-e="4">{{a.modulo4}}</td>
        <td class="c" data-item-e="5">{{a.modulo5}}</td>
        <td class="c" data-item-e="6">{{a.modulo6}}</td>
        <td class="c" data-item-e="7">{{a.modulo7}}</td>
        <td class="c" data-item-e="8">{{a.modulo8}}</td>
        <td class="c" data-item-e="9">{{a.modulo9}}</td>
        <td class="c" data-item-e="10">{{a.modulo10}}</td>
        <td class="c" data-item-e="11">{{a.modulo11}}</td>
        <td class="c" data-item-e="12">{{a.modulo12}}</td>
        <td class="c" data-item-e="13">{{a.modulo13}}</td>
        <td class="c" data-item-e="14">{{a.modulo14}}</td>
        <td class="c" data-item-e="15">{{a.modulo15}}</td>
        <td class="c" data-item-e="16">{{a.modulo16}}</td>
        <td class="c" data-item-e="17">{{a.modulo17}}</td>
        <td class="c" data-item-e="18">{{a.modulo18}}</td>
        <td class="c" data-item-e="19">{{a.modulo19}}</td>
        <td class="c" data-item-e="20">{{a.modulo20}}</td>
        <td class="c" data-item-e="21">{{a.modulo21}}</td>
        <td class="c" data-item-e="22">{{a.modulo22}}</td>
        <td class="c" data-item-e="23">{{a.modulo23}}</td>
        <td class="c" data-item-e="24">{{a.modulo24}}</td>
        <td class="c" data-item-e="25">{{a.modulo25}}</td>
        <td class="c" data-item-e="26">{{a.modulo26}}</td>
        <td class="c" data-item-e="27">{{a.modulo27}}</td>
        <td class="c" data-item-e="28">{{a.modulo28}}</td>
        <td>{{a.asistenciahoras}}</td>
        <td>{{a.porcentajehoras}}%</td>
        <td  class="b" data-item-n="1">{{a.nota}}</td>
        <td  class="b"data-item-n="2">{{a.nota2}}</td>
        <td  class="b"data-item-n="3">{{a.nota3}}</td>
        <td  class="b"data-item-n="4">{{a.nota4}}</td>
        <td  class="b"data-item-n="5">{{a.nota5}}</td>
        <td  class="b"data-item-n="6">{{a.nota6}}</td>
        <td  class="b"data-item-n="7">{{a.nota7}}</td>
        <td  class="b"data-item-n="8">{{a.nota8}}</td>
        <td  class="b"data-item-n="9">{{a.nota9}}</td>
        <td  class="b"data-item-n="10">{{a.nota10}}</td>
        <td  class="b"data-item-n="11">{{a.nota11}}</td>
        <td  class="b"data-item-n="12">{{a.nota12}}</td>
        <td  class="b"data-item-n="13">{{a.nota13}}</td>
        <td  class="b"data-item-n="14">{{a.nota14}}</td>
        <td  class="b"data-item-n="15">{{a.nota15}}</td>
        <td  class="b"data-item-n="16">{{a.nota16}}</td>
        <td  class="b"data-item-n="17">{{a.nota17}}</td>
        <td  class="b"data-item-n="18">{{a.nota18}}</td>
        <td  class="b"data-item-n="19">{{a.nota19}}</td>
        <td  class="b"data-item-n="20">{{a.nota20}}</td>
        <td  class="b"data-item-n="21">{{a.nota21}}</td>
        <td  class="b" data-item-n="22">{{a.nota22}}</td>
        <td  class="b" data-item-n="23">{{a.nota23}}</td>
        <td  class="b" data-item-n="24">{{a.nota24}}</td>
        <td  class="b" data-item-n="25">{{a.nota25}}</td>
        <td  class="b" data-item-n="26">{{a.nota26}}</td>
        <td  class="b" data-item-n="27">{{a.nota27}}</td>
        <td  class="b" data-item-n="28">{{a.nota28}}</td>
        <td>{{a.valor}}%</td>
        <td>{{a.valor2}}</td>
        <td>{{a.valor3}}</td>
        <td>{{a.valor4}}</td>

      </tr>
      {% endfor %}

    </tbody>
  </table>  


<script>
 $(document).ready(function() {
    
    for(var index = 1; index < 29; index++){
      get_total("td[data-item-e="+ index +"]", "th[data-item="+ index +"]"); 
 
    }
 });
  

function get_total(data, data2){
  var sum = 0;
  $("#customers tbody tr").find(data).each(function(index, el) {   
      sum += parseFloat($(this).text());

  });
  if (sum == 0)
  {
    $("#customers tbody tr").find(data).hide();
    $("#customers thead tr").find(data2).hide();
  }
}


</script>

<script>
 $(document).ready(function() {
    
    for(var index = 1; index < 29; index++){
      get_totaln("td[data-item-n="+ index +"]", "th[data-item-w="+ index +"]");  
    }
 });
  

function get_totaln(data3,data4){
  var sum = 0;
  $("#customers tbody tr").find(data3).each(function(index, el) {   
      sum += parseFloat($(this).text());
      //alert(sum)
  });
  if (sum == 0){
    $("#customers tbody tr").find(data3).hide();
    $("#customers thead tr").find(data4).hide();
  }
}


</script>




<script>
$(document).ready(function() {
    $('#customers').DataTable( {
        iDisplayLength: '500000',
        dom: 'Bfrtip',
        buttons: [
            'excelHtml5',            
            'pdfHtml5',
        ]
    });
} );
</script>

</div>



 <script type="text/javascript" src="/static/js/tableExport.js"></script>
 <script type="text/javascript" src="/static/js/jquery.base64.js"></script>
<script type="text/javascript" src="/static/js/html2canvas.js"></script>
<script type="text/javascript" src="/static/js/jspdf/libs/sprintf.js"></script>
<script type="text/javascript" src="/static/js/jspdf/jspdf.js"></script>
<script type="text/javascript" src="/static/js/jspdf/libs/base64.js"></script>
<script>
onClick ="$('#tableID').tableExport({type:'pdf',escape:'false'});"

</script>

<script type="text/javascript">
$("#reset").click(function () {
      location.reload();
    });
</script>



</div>
</div>
</div>
</div>
</div>
</div>
<script type="text/javascript">

        $(document).ready(function() {


          $("#proceso").click(function() {
            var x = $(this).val();
            $("#total").append(x);

            });

            $("#sel1").click(function() {
            var x = $(this).val();
            $("#total").append(x);

            });


            $("#proyectos").change(function() {
            var y = $(this).val();
            $("#total").append(y);

            });



            $("#zip").change(function() {
            var z = $(this).val();
            $("#total").append(z);

            });


            $("#departamento").change(function() {
            var d = $(this).val();
            $("#total").append(d);
            });

            $("#categoria").change(function() {
            var ca = $(this).val();
            $("#total").append(ca);
            });



           $("#operador").change(function() {
            var a = $(this).val();
            $("#total").append(a);
            });

           $("#inactive").change(function() {
            var i = $(this).val();
            $("#total").append(i);
            });

            $("#numero").change(function() {
            var n = $(this).val();
            $("#total").append(n);
            });


            $("#code").change(function() {
            var code = $(this).val();
            $("#total").append(code);
            });



             $("#andor").change(function() {
            var t = $(this).val();
            $("#total").append(t);

            });



        });


     $("button").submit(function(){
    $.post("/exportar/", function(data, status){
        alert("Data: " + data + "\nStatus: " + status);
    });
});

    </script>

<script type="text/javascript">
      $(document).ready(function(){
              $("#limpiar").click(function(){
              $("#fomulario")[0].reset();
              });});

    </script>

{# plugin datepicker#}
<script>
   $(function() {
    $('#datepicker').datepicker({
        dateFormat: 'yy-mm-dd',
{#        onSelect: function(datetext){#}
{#            var d = new Date(); // for now#}
{#            datetext=datetext+" "+d.getHours()+": "+d.getMinutes()+": "+d.getSeconds();#}
{#            $('#datepicker').val(datetext);#}
{#        },#}
    });
});
  </script>
<script>


$(function() {
    $('#datepicker2').datepicker({
        dateFormat: 'yy-mm-dd',
{#        onSelect: function(datetext){#}
{#            var d = new Date(); // for now#}
{#            datetext=datetext+" "+d.getHours()+": "+d.getMinutes()+": "+d.getSeconds();#}
{#            $('#datepicker2').val(datetext);#}
{#        },#}
    });
});
  </script>
{# plugin datepicker#}
  </script>
     {% if error %}
             <script>
                 alert('{{ error }}');
                 window.location= "/reporte_condensado_proceso/"
             </script>
         {% endif %}

<script type="text/javascript">

$(function(){
    // Clona la fila oculta que tiene los campos base, y la agrega al final de la tabla
    $("#agregar").on('click', function(){
       $("#tabla tbody tr:eq(0)").clone().appendTo("#resultado");

       $('#perron').on('click',function(){
         var papa =$(this).text()
         $("#valores").html('<html> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 well"><form action="/exportar_condensado_proceso/" method="post" id="formulario" role="form" enctype="multipart/form-data"><br> <input type="hidden" name="total" id=""  value="'+papa+'"class="form-control"> Usted Eligio los Siguiente Parametros'+papa+'</input><br><br><br><button type="submit" class="btn btn-primary">Enviar Consulta</button><form></div></html>');

       });

    });

    // Evento que selecciona la fila y la elimina
    $(document).on("click",".eliminar",function(){
        var parent = $(this).parents().get(0);
        $(parent).remove();
    });





});



$("#del").click(function(){

            // Obtenemos el total de columnas (tr) del id "tabla"

            var trs=$("#eliminar tr").length;

            if(trs>1)

            {

                // Eliminamos la ultima columna

                $("#eliminar tr:last").remove();

            }

});
</script>
<script type="text/javascript">
$("#reset").click(function () {
      location.reload();
    });
</script>
<script type="text/javascript">

        $(document).ready(function() {

            $("#sel1").click(function() {
            var x = $(this).val();
            $("#sz").html(x);

            });


            $("#proyectos").change(function() {
            var y = $(this).val();
            $("#pa").html(y);

            });


             $("#like").change(function() {
            var d = $(this).val();
            var name = "''%"+d+"%''";
            $("#pa").html(name);
            });



            $("#datepicker").click(function() {
            var ac = $(this).val();
            var fecha = "''"+ac+"''";
            $("#pa").html(fecha);
            });



            $("#cuenta").click(function() {
            var cuenta = $(this).val();
            var fecha = "''"+cuenta+"''";
            $("#pa").html(fecha);
            });




            $("#zip").change(function() {
            var z = $(this).val();
            $("#pa").html(z);

            });

              $("#proceso").change(function() {
            var z = $(this).val();
            $("#pa").html(z);

            });



            $("#departamento").change(function() {
            var d = $(this).val();
            $("#pa").html(d);
            });

            $("#status").change(function() {
            var ca = $(this).val();
            $("#pa").html(ca);
            });



           $("#operador").change(function() {
            var a = $(this).val();
            $("#oper").html(a);
            });

           $("#inactive").change(function() {
            var i = $(this).val();
            $("#pa").html(i);
            });

            $("#numero").change(function() {
            var n = $(this).val();
            $("#pa").html(n);
            });


            $("#code").change(function() {
            var code = $(this).val();
            $("#pa").html(code);
            });


            $("#proceso").change(function() {
            var code = $(this).val();
            $("#pa").html(code);
            });



            $("#opcionedu").change(function() {
            var code = $(this).val();
            $("#pa").html(code);
            });

            $("#andor").change(function() {
            var t = $(this).val();
            $("#co").html(t);

            });


        });


         $("button").submit(function(){
        $.post("/exportar/", function(data, status){
            alert("Data: " + data + "\nStatus: " + status);
                });
            });

    </script>
<script type="text/javascript">
      $(document).ready(function(){
              $("#limpiar").click(function(){
              $("#fomulario")[0].reset();
              });});

    </script>

<script type="text/javascript">
$(function() {
    $('#datepicker').datepicker({
      dateFormat: 'yy-mm-dd',


    });
});
</script>

</body>
{% endblock %}



 <script src="/sie/static/js/bootstrap.min.js"></script>
    <script src="/static/js/bootstrap-datepicker3.min.css"></script>
</html>